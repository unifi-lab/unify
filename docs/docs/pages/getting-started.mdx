# Getting Started

Unify API is a Hono-based SDK that automatically maps entity configurations to REST API endpoints. It provides built-in CRUD operations, query parameter support, and automatic OpenAPI documentation generation.

## Features

- 🚀 Built on [Hono](https://hono.dev/) high-performance web framework
- 📦 Automatically map entity methods to REST API endpoints
- 🔧 Support for query parameters (limit, offset, select, where, order_by)
- 🛡️ Built-in error handling and response standardization
- 📚 Automatic OpenAPI documentation generation
- 🔌 Support for custom middleware
- 💪 Full TypeScript support
- 🗄️ Support for table configurations and built-in CRUD methods

## Installation

```bash
npm install unify-api
```

## Quick Start

Here's a basic example to get you started:

```typescript
import { createSource } from 'unify-api';

// Create a source instance
const source = createSource();

// Sample data
const users = [
  { id: 1, name: "Alice", age: 25 },
  { id: 2, name: "Bob", age: 30 },
];

// Register entity configuration
source.register({
  id: "my-api",
  entities: {
    user: {
      findMany: async (args) => {
        const { where, select, limit, offset } = args || {};
        let result = users;
        
        // Apply where filtering
        if (where) {
          result = users.filter((record) =>
            Object.entries(where).every(([key, value]) => record[key] === value)
          );
        }
        
        // Apply offset and limit
        if (offset) result = result.slice(offset);
        if (limit) result = result.slice(0, limit);
        
        // Apply field selection
        if (select) {
          result = result.map((user) => 
            select.reduce((acc, field) => ({ ...acc, [field]: user[field] }), {})
          );
        }
        
        return result;
      },
      
      findOne: async (args) => {
        const { where, select } = args || {};
        let result = users.find((record) =>
          Object.entries(where || {}).every(([key, value]) => record[key] === value)
        );
        
        if (result && select) {
          result = select.reduce((acc, field) => ({ ...acc, [field]: result[field] }), {});
        }
        
        return result;
      },
      
      create: async (args) => {
        const { data } = args || {};
        const newUser = {
          id: users.length + 1,
          ...data
        };
        users.push(newUser);
        return newUser;
      },
    },
  },
});

// Get the Hono app instance
const app = source.getApp();

// Start the server (using Bun as an example)
export default {
  port: 3000,
  fetch: app.fetch,
};
```

## API Endpoint Mapping

The SDK automatically maps entity methods to REST API endpoints:

| Method | HTTP Method | Path | Description |
|--------|-------------|------|-------------|
| `findMany` | GET | `/{entity}/list?source_id={source_id}` | Find multiple records |
| `findOne` | GET | `/{entity}/find_one?source_id={source_id}` | Find a single record |
| `create` | POST | `/{entity}/create?source_id={source_id}` | Create a new record |
| `update` | PATCH | `/{entity}/update?source_id={source_id}` | Update existing record |
| `delete` | DELETE | `/{entity}/delete?source_id={source_id}` | Delete a record |

## Query Parameters

The following query parameters are supported:

- **`limit`**: Limit the number of records returned
- **`offset`**: Skip a specified number of records
- **`select`**: Select specific fields to return (comma-separated or JSON array)
- **`where`**: Filter conditions in JSON format
- **`order_by`**: Sorting rules in JSON format or `field:asc/desc` format

### Example Requests

```bash
# Get first 10 users
GET /user/list?source_id=my-api&limit=10

# Get specific fields
GET /user/list?source_id=my-api&select=["name","age"]

# Filter by conditions
GET /user/list?source_id=my-api&where={"age":25}

# Sort results
GET /user/list?source_id=my-api&order_by={"name":"asc"}

# Combine parameters
GET /user/list?source_id=my-api&where={"age":25}&select=["name"]&limit=5
```

## Next Steps

- Explore the [Examples](/examples) to see more advanced usage patterns
- Learn about [middleware support](/middleware) for authentication and custom logic
- Check out [table configurations](/tables) for database integration
- See [API reference](/api-reference) for complete method documentation