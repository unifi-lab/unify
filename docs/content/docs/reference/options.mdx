---
title: API Reference
description: Complete API reference for Unify packages including @unilab/core, @unilab/unify-hono, and @unilab/unify.
---

# @unilab/core

Core types and interfaces for the Unify framework.

## Repository Operations Arguments

### FindManyArgs

Arguments for finding multiple records.

```typescript
interface FindManyArgs<T extends Record<string, any>> {
  limit?: number;
  offset?: number;
  where?: Partial<T>;
  order_by?: Partial<Record<keyof T, "asc" | "desc">>;
  include?: {
    [key: string]: RelationCallbackMany<T, any>;
  };
}

export type RelationCallbackMany<T extends Record<string, any>, R extends Record<string, any>> = (
  entities: T[]
) => Promise<R[]>;
```

**Properties:**
- `limit` - Maximum number of records to return
- `offset` - Number of records to skip
- `where` - Filter conditions
- `order_by` - Sort order specification
- `include` - Include related entities

### FindOneArgs

Arguments for finding a single record.

```typescript
interface FindOneArgs<T extends Record<string, any>> {
  where: Partial<T>;
}
```

**Properties:**
- `where` - Filter conditions (required)

### CreationArgs

Arguments for creating a new record.

```typescript
interface CreationArgs<T extends Record<string, any>> {
  data: Partial<T>;
}
```

**Properties:**
- `data` - Data for the new record

### UpdateArgs

Arguments for updating an existing record.

```typescript
interface UpdateArgs<T extends Record<string, any>> {
  where: Partial<T>;
  data: Partial<T>;
}
```

**Properties:**
- `where` - Filter conditions to identify records to update
- `data` - New data for the record

### DeletionArgs

Arguments for deleting records.

```typescript
interface DeletionArgs<T extends Record<string, any>> {
  where: Partial<T>;
}
```

**Properties:**
- `where` - Filter conditions to identify records to delete

## DataSourceAdapter

Interface that all data source adapters must implement.

```typescript
interface DataSourceAdapter<T extends Record<string, any>> {
  findMany(args: FindManyArgs<T>): Promise<T[]>;
  findOne(args: FindOneArgs<T>): Promise<T | null>;
  create(args: CreationArgs<T>): Promise<T>;
  update(args: UpdateArgs<T>): Promise<T>;
  delete(args: DeletionArgs<T>): Promise<boolean>;
}
```

## Repository

Repository class for interacting with data sources.

```typescript
class Repository<T extends Record<string, any>> {
  constructor(adapter: DataSourceAdapter<T>);
  
  async findMany(args?: FindManyArgs<T>): Promise<T[]>;
  async findOne(args?: FindOneArgs<T>): Promise<T | null>;
  async create(args: CreationArgs<T>): Promise<T>;
  async update(args: UpdateArgs<T>): Promise<T>;
  async delete(args: DeletionArgs<T>): Promise<boolean>;
}
```

## Utility Functions

### registerAdapter

Register a data source adapter.

```typescript
function registerAdapter<T extends Record<string, any>>(
  name: string,
  adapterFactory: () => DataSourceAdapter<T>
): void
```

### Repo

Create a repository instance for a specific entity and source.

```typescript
function Repo<T extends Record<string, any>>(
  entityName: string,
  source: string
): Repository<T>
```

# @unilab/unify-hono

Server-side components for creating Unify API servers.

## Unify

Main class for creating and configuring Unify servers.

### Static Methods

#### init

Initialize the Unify server with optional configuration.

```typescript
static init(config?: UnifyConfig): Hono
```

**Parameters:**
- `config.app` - Optional external Hono app instance

**Returns:** Hono app instance

**Example:**
```typescript
import { Unify } from "@unilab/unify-hono";
import { Hono } from "hono";

// Use default app
const app = Unify.init();

// Use external app
const customApp = new Hono();
Unify.init({ app: customApp });
```

#### register

Register data source adapters and create API routes.

```typescript
static register(adapters: AdapterRegistration[]): Hono
```

**Parameters:**
- `adapters` - Array of adapter registrations

**Returns:** Hono app instance with registered routes

**Example:**
```typescript
import { Unify } from "@unilab/unify-hono";
import { SolanaAdapter, EVMAdapter } from "@unilab/uniweb3";

const server = Unify.register([
  { source: "solana", adapter: new SolanaAdapter() },
  { source: "evm", adapter: new EVMAdapter() },
]);
```

#### getApp

Get the current Hono app instance.

```typescript
static getApp(): Hono
```

## Configuration Interfaces

### UnifyConfig

Configuration options for initializing Unify.

```typescript
interface UnifyConfig {
  app?: Hono;
}
```

### AdapterRegistration

Registration configuration for data source adapters.

```typescript
interface AdapterRegistration {
  source: string;
  adapter: DataSourceAdapter<any>;
}
```

**Properties:**
- `source` - Unique identifier for the data source
- `adapter` - Data source adapter instance

## Utility Functions

### registerAdapter

Register a data source adapter in the global registry.

```typescript
function registerAdapter<T extends Record<string, any>>(
  name: string,
  adapterFactory: () => DataSourceAdapter<T>
): void
```

### getAdapter

Retrieve a registered adapter by name.

```typescript
function getAdapter<T extends Record<string, any>>(
  source: string
): DataSourceAdapter<T>
```

### parseQueryParams

Parse HTTP query parameters into structured arguments.

```typescript
function parseQueryParams<T extends Record<string, any>>(c: Context): any
```

### handleError

Handle and format errors for HTTP responses.

```typescript
function handleError(error: unknown, c: Context): Response
```

### validateSource

Validate that a required source parameter is provided.

```typescript
function validateSource(source: string | undefined, c: Context): Response | null
```

# @unilab/unify-client

Client-side components for consuming Unify APIs.

## UnifyClient

Main client class for interacting with Unify APIs.

### Constructor

```typescript
constructor(config: ClientConfig)
```

**Parameters:**
- `config` - Client configuration options

### Instance Methods

#### createRepositoryProxy

Create a repository proxy for a specific entity and data source.

```typescript
createRepositoryProxy<T extends Record<string, any>>(
  entityName: string,
  source: string
): Repository<T>
```

**Parameters:**
- `entityName` - Name of the entity
- `source` - Data source identifier

**Returns:** Repository instance for the specified entity

### Static Methods

#### init

Initialize the global client instance.

```typescript
static init(config: ClientConfig): void
```

**Parameters:**
- `config` - Client configuration options

**Example:**
```typescript
import { UnifyClient } from "@unilab/unify-client";

UnifyClient.init({
  baseUrl: "http://localhost:3000",
  timeout: 10000,
  headers: {
    Authorization: "Bearer token",
  },
});
```

#### Repo

Create a repository instance using the global client.

```typescript
static Repo<T extends Record<string, any>>(
  entityName: string,
  source: string
): Repository<T>
```

**Example:**
```typescript
import { UnifyClient } from "@unilab/unify-client";
import { WalletEntity } from "@unilab/uniweb3/entities";

const walletRepo = UnifyClient.repo<WalletEntity>("wallet", "evm");
```

## Configuration Interfaces

### ClientConfig

Configuration options for the Unify client.

```typescript
interface ClientConfig {
  baseUrl: string;
  timeout?: number;
  headers?: Record<string, string>;
}
```

**Properties:**
- `baseUrl` - Base URL of the Unify server (required)
- `timeout` - Request timeout in milliseconds (default: 5000)
- `headers` - Default headers to include with requests

### HttpRequestOptions

Internal interface for HTTP request configuration.

```typescript
interface HttpRequestOptions {
  method: "GET" | "POST" | "PATCH" | "DELETE";
  url: string;
  params?: Record<string, any>;
  data?: any;
  headers?: Record<string, string>;
}
```

### ApiResponse

Interface for API response structure.

```typescript
interface ApiResponse<T = any> {
  data: T;
  success: boolean;
  message?: string;
}
```

## Utility Functions

### Repo

Global convenience function for creating repository instances.

```typescript
function Repo<T extends Record<string, any>>(
  entityName: string,
  source: string
): Repository<T>
```

**Example:**
```typescript
import { repo } from "@unilab/unify-client";
import { WalletEntity } from "@unilab/uniweb3/entities";

// Initialize client first
UnifyClient.init({ baseUrl: "http://localhost:3000" });

// Use the convenience function
const walletRepo = repo<WalletEntity>("wallet", "solana");
const wallet = await walletrepo.findOne({
  where: { address: "11111111111111111111111111111112" }
});
```

## API Routes

The Unify server automatically generates the following REST API endpoints when adapters are registered:

### GET /\{entity\}/list

Find multiple records.

**Query Parameters:**
- `source` (required) - Data source identifier
- `limit` - Maximum number of records to return
- `offset` - Number of records to skip
- `where` - JSON filter conditions
- `order_by` - JSON sort specification
- `include` - Include related entities

**Example:**
```bash
GET /wallet/list?source=evm&limit=10&where={"network":"ethereum"}
```

### GET /\{entity\}/find_one

Find a single record.

**Query Parameters:**
- `source` (required) - Data source identifier
- `where` (required) - JSON filter conditions
- `include` - Include related entities

**Example:**
```bash
GET /wallet/find_one?source=solana&where={"address":"11111111111111111111111111111112"}
```

### POST /\{entity\}/create

Create a new record.

**Query Parameters:**
- `source` (required) - Data source identifier

**Request Body:**
```json
{
  "data": {
    "field1": "value1",
    "field2": "value2"
  }
}
```

### PATCH /\{entity\}/update

Update an existing record.

**Query Parameters:**
- `source` (required) - Data source identifier

**Request Body:**
```json
{
  "where": {
    "id": "record_id"
  },
  "data": {
    "field1": "new_value"
  }
}
```

### DELETE /\{entity\}/delete

Delete records.

**Query Parameters:**
- `source` (required) - Data source identifier
- `where` (required) - JSON filter conditions

**Example:**
```bash
DELETE /wallet/delete?source=evm&where={"id":"wallet_id"}
```

### GET /health

Health check endpoint.

**Response:**
```json
{
  "status": "ok",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "adapters": ["solana", "evm"]
}
```

## Error Handling

All endpoints return consistent error responses:

```json
{
  "error": "Error message describing what went wrong"
}
```

Common HTTP status codes:
- `400` - Bad Request (missing required parameters, invalid JSON)
- `404` - Not Found (unknown entity or source)
- `500` - Internal Server Error (adapter errors, database errors)

## Usage Examples

### Basic Server Setup

```typescript
import { Unify } from "@unilab/unify-hono";
import { SolanaAdapter, EVMAdapter } from "@unilab/uniweb3";

// Register adapters and start server
const server = Unify.register([
  { source: "solana", adapter: new SolanaAdapter() },
  { source: "evm", adapter: new EVMAdapter() },
]);

export default {
  port: 3000,
  fetch: server.fetch,
};
```

### Basic Client Usage

```typescript
import { UnifyClient, repo } from "@unilab/unify-client";
import { WalletEntity } from "@unilab/uniweb3/entities";

// Initialize client
UnifyClient.init({
  baseUrl: "http://localhost:3000",
  timeout: 10000,
});

// Query wallet balance
const wallet = await repo<WalletEntity>("wallet", "solana").findOne({
  where: { address: "11111111111111111111111111111112" }
});

console.log("Wallet balance:", wallet?.balance);
```

### Custom Adapter Implementation

```typescript
import type { DataSourceAdapter } from "@unilab/core";

interface CustomEntity extends Record<string, any> {
  id: string;
  name: string;
}

class CustomAdapter implements DataSourceAdapter<CustomEntity> {
  async findMany(args: FindManyArgs<CustomEntity>): Promise<CustomEntity[]> {
    // Implementation
    return [];
  }

  async findOne(args: FindOneArgs<CustomEntity>): Promise<CustomEntity | null> {
    // Implementation
    return null;
  }

  async create(args: CreationArgs<CustomEntity>): Promise<CustomEntity> {
    // Implementation
    return { id: "1", name: "test" };
  }

  async update(args: UpdateArgs<CustomEntity>): Promise<CustomEntity> {
    // Implementation
    return { id: "1", name: "updated" };
  }

  async delete(args: DeletionArgs<CustomEntity>): Promise<boolean> {
    // Implementation
    return true;
  }
}

// Register custom adapter
const server = Unify.register([
  { source: "custom", adapter: new CustomAdapter() },
]);
```
